<?xml version='1.0' encoding='UTF-8'?>
<com.cloudbees.plugins.flow.BuildFlow plugin="build-flow-plugin@0.9">
  <actions/>
  <description>Run as downstream job from scala-release-2.11.x.&#xd;
&lt;p&gt;&#xd;
Coordinates the build of a Scala distribution based on artifacts on maven (built by scala-release-2.11.x).&#xd;
Downstream jobs: scala-release-2.11.x-[unix|windows|scala-lang].&#xd;
&lt;p&gt;&#xd;
Nightly downloads go to http://www.scala-lang.org/files/archive/nightly/2.11.x/ &lt;br&gt;&#xd;
  Regular ones to http://www.scala-lang.org/files/archive/</description>
  <keepDependencies>false</keepDependencies>
  <properties>
    <hudson.model.ParametersDefinitionProperty>
      <parameterDefinitions>
        <%= scmUserParam("scala") %>
        <%= scmRefParam("2.11.x") %>
        <hudson.model.StringParameterDefinition>
          <name>version</name>
          <description>version of Scala to build a distribution for, there must be a corresponding &quot;v$version&quot; tag in scala/scala-dist,&lt;br&gt;and a &quot;org.scala-lang&quot; : &quot;scala-dist&quot; : $version artifact on maven</description>
          <defaultValue></defaultValue>
        </hudson.model.StringParameterDefinition>
      </parameterDefinitions>
    </hudson.model.ParametersDefinitionProperty>
    <com.sonyericsson.rebuild.RebuildSettings plugin="rebuild@1.21">
      <autoRebuild>false</autoRebuild>
    </com.sonyericsson.rebuild.RebuildSettings>
    <hudson.plugins.throttleconcurrents.ThrottleJobProperty plugin="throttle-concurrents@1.8.2">
      <maxConcurrentPerNode>0</maxConcurrentPerNode>
      <maxConcurrentTotal>0</maxConcurrentTotal>
      <throttleEnabled>false</throttleEnabled>
      <throttleOption>project</throttleOption>
    </hudson.plugins.throttleconcurrents.ThrottleJobProperty>
  </properties>
  <scm class="hudson.scm.NullSCM"/>
  <canRoam>true</canRoam>
  <disabled>false</disabled>
  <blockBuildWhenDownstreamBuilding>false</blockBuildWhenDownstreamBuilding>
  <blockBuildWhenUpstreamBuilding>false</blockBuildWhenUpstreamBuilding>
  <triggers/>
  <concurrentBuild>false</concurrentBuild>
  <builders/>
  <publishers/>
  <buildWrappers/>
  <icon/>
  <dsl>ver = params[&quot;version&quot;]
build.setDisplayName(&quot;Scala distribution ${ver} [${build.number}]&quot;)

if (params.repo_ref) buildParams = params
else buildParams = params + [ &apos;repo_ref&apos; : &quot;v$ver&quot; ]

buildRun = build(buildParams, &quot;scala-release-2.11.x-build&quot;)

upstreamBuild = buildRun.build
// for testing, to avoid re-running the main build: upstreamBuild = jenkins.model.Jenkins.instance.items.find{it.name == &quot;scala-release-2.11.x-build&quot;}.builds[0]
// defines repo_ref, version, sbtDistVersionOverride
upstreamPropsArtifact = upstreamBuild.artifacts.find{it.name == &quot;jenkins.properties&quot;}

buildVersionProps = new java.util.Properties()
buildVersionProps.load(new java.io.FileInputStream(upstreamPropsArtifact.file))

testParams = buildParams + buildVersionProps

parallel (
    { build(testParams, &quot;scala-release-2.11.x-unix&quot;) },
    { build(testParams, &quot;scala-release-2.11.x-windows&quot;) }
)

build(testParams, &quot;scala-release-2.11.x-smoketest&quot;)

build(testParams, &quot;scala-release-2.11.x-scala-lang&quot;)

</dsl>
</com.cloudbees.plugins.flow.BuildFlow>